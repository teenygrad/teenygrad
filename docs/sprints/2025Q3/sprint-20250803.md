# Week ending - 03/Aug/2025

## Sprint Goal

Get Qwen3 working on CPU using ndarray.

### Tasks

1. Qwen3 graph completed with safetensors.
2. Compiler to convert the graph to ndarray implementation.
3. Fix all the issues that arise.

### Tech debt

- Shape tracked has been removed during this sprint, to take a step back and design a better shape tracking system.
- The API is not very ergonomic at the moment, will need to revisit once the whole thing works and I have a clearer idea of what the right traits and structs are.
- Modify project to use error_stack as that is more ergonomic as it has good compatibility with thiserror and provides stack traces. With anyhow we lose the error type because it used a dyn.
- Moving to mixed precision has meant that there is less compile time safety. This needs to be revisited to see how we can gain leverage Rust for a more type safe graph API.

### Sprint Review

- Good
  - Graph changes needed to Qwen3 required modifying the graph API to support multi-precision. This would have been difficult to retro-fit so a goog by-product.

- Bad
  - The sprint goal of getting an ndarray implementation did not get completed. This was partly due to multi-precision which was unplanned but also the conversion itself requires quite a lot of manual comparison to the huggingface implementation.

- Ugly
  - Multi-precision requires sophisticated handling to use the Rust type system, and the current implementation is quick and dirty.
