# Week ending - 14/Sep/2025

## Sprint Goal

- Complete type inference for simple vector addition using Z3.

### Tasks for MMVP

1. Complete type inference for simple vector addition.
2. Write triton kernel for vector addition in rust.
3. Generate MLIR module for the fxgraph.`
4. Compile module to PTX for Blackwell.
5. Cache the compiled PTX, and cubin for sm_120.
6. Launch kernel on call to forward.

### Tech debt

- egg lang schema is not fit for purpose due to being too generic, this needs to be changed.
- conversions from pytorch schema to our internal schema is not the way Rust does things, this needs to be revisited.
- better error messages for invalid data from pytorch
- simple type inference implemented, need to implement something much better but this will be in concert with a much better IR inspired by TVM in Phase 2 of the project.

### Sprint Review

- Was sprint goal achieved?

Yes, but with a major caveat. The original idea was to lean heavily on z3 for the type inference. Once I started on this it became apparent that the shape verification wasn't going to be viable in z3 (first order logic is undecideable, and z3 has limited support for theories that could help). It was worthwhile to investigate z3, and I've come away with a much better understanding of how it works and the theories it supports.

The sprint also got slightly side tracked by some work I've been doing with re-inforcement learning, and I've made a commitment to make a presentation on large survey paper which I need to prepare for. The audience are hard core machine learning theorists, so I'm going to need to ensure I am up to scratch on all the details.

- Good
  - Good handle on z3. The type inference problem for fxgraphs is actually not hard, so I just did a very basic version of it.

- Bad
  - Velocity has really dropped, this has been mainly due to distractions and side tracks which ended up going no where. I need to get back to the level of productivity in the early days.

- Ugly
  - To Do
