# Week ending - 07/Sep/2025

## Sprint Goal

Make progress on end-to-end compilation of vector addition on Blackwell. Try and get at least 25% of the tasks completed this sprint.

### Tasks

1. Capture fxgraph with enough details to perform type checking analysis on the egraph.
2. Write triton kernel for vector addition in rust.
3. Generate MLIR module for the fxgraph.
4. Compile module to PTX for Blackwell.
5. Cache the compiled PTX, and cubin for sm_120.
6. Launch kernel on call to forward.

### Tech debt

- egg lang schema is not fit for purpose due to being too generic, this needs to be changed.
- conversions from pytorch schema to our internal schema is not the way Rust does things, this needs to be revisited.
- better error messages for invalid data from pytorch

### Sprint Review

- Was sprint goal achieved?
No, the fxgraph has been built and all the type info available has been captured. The actual type checking has not been done.

To Do.

- Good
  - FXGraph capture for Qwen3 and simple vector addition has been completed.
  - Investigated Z3 for type inference, may not be totally suitable for the eventual system. Deepseek recommened a hybrid approach using Hindley-Milner and Z3, to ensure performance on large graphs. A bit of nostalgia since I worked in the same building as Robin Milner and saw him often as a young PhD student.

- Bad
  - Sprint goal not achieved, this was primarily due to the type inference which caused a major detour into z3. Will be worthwhile in the long term, but short term it's taken a lot of time.

- Ugly
  - Python type system.
